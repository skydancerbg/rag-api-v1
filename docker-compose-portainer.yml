# docker-compose-portainer.yml v1.2.9
# Description: Portainer stack for rag-api v1.2.9; only image tag updated

version: "3.9"

services:
  rag-api:
    image: ghcr.io/skydancerbg/rag-api:v1.2.9
    container_name: rag-api
    ports:
      - "5005:5005"
    volumes:
      # Project files (read-only)
      - /opt/rag-api/rag-api:/app/rag_api:ro
      # NFS documents (read-only)
      - /mnt/ai-rag-files:/mnt/ai-rag-files:ro
      # Config mounted at runtime
      - /opt/rag-api/config:/app/config:ro
    restart: unless-stopped
    pull_policy: if_not_present
    healthcheck:
      test: ["CMD-SHELL", "curl -sSf http://localhost:5005/health || exit 1"]
      interval: 30s
      timeout: 5s
      retries: 3
